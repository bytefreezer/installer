# ByteFreezer Proxy Helm Chart Values
# Edge data collection and forwarding to receiver

# Receiver configuration
receiver:
  # URL of the ByteFreezer receiver webhook endpoint
  url: ""  # e.g., https://receiver.example.com:8080

# Control Service configuration
controlService:
  url: ""  # e.g., https://api.bytefreezer.com
  apiKey: ""
  # Use existing secret for API key (key: apiKey)
  existingSecret: ""
  timeoutSeconds: 30

# Replica count
replicaCount: 1

# Image configuration
image:
  repository: ghcr.io/bytefreezer/bytefreezer-proxy
  tag: ""  # Defaults to Chart.appVersion
  pullPolicy: IfNotPresent

imagePullSecrets: []

# Service account
serviceAccount:
  create: true
  name: ""
  annotations: {}

# API service (health checks, metrics)
service:
  type: ClusterIP
  apiPort: 8008

# UDP listener configuration
# Define ports based on your control service plugin configuration
udp:
  enabled: true
  ports:
    - port: 5514
      name: syslog
  service:
    type: LoadBalancer
    # MetalLB Configuration (for k3s/bare-metal with MetalLB)
    # Specify a static IP from your MetalLB pool
    loadBalancerIP: ""
    # Service annotations
    annotations: {}
      # MetalLB annotations (uncomment as needed):
      # metallb.universe.tf/loadBalancerIPs: "192.168.1.101"
      # metallb.universe.tf/address-pool: "default"
      # metallb.universe.tf/allow-shared-ip: "bytefreezer-proxy"

# Webhook listener (optional)
webhook:
  enabled: false
  port: 8080

# Batching configuration
batching:
  enabled: true
  maxLines: 10000
  maxBytes: 10485760  # 10MB
  timeoutSeconds: 30
  compressionEnabled: true
  compressionLevel: 6

# Spooling configuration (local disk buffer)
spooling:
  enabled: true
  directory: "/var/spool/bytefreezer-proxy"
  maxSizeBytes: 1073741824  # 1GB
  retryAttempts: 3
  retryIntervalSeconds: 60

# Health reporting to control service
healthReporting:
  enabled: true
  reportInterval: 30

# Monitoring/metrics
monitoring:
  enabled: false
  # Mode: "prometheus" (pull), "otlp_http" (push), "otlp_grpc" (push)
  mode: "prometheus"
  # External endpoint for push modes
  endpoint: ""
  pushIntervalSeconds: 15
  metricsPort: 9090

# Resource limits
resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 1000m
    memory: 1Gi

# Pod settings
nodeSelector: {}
tolerations: []
affinity: {}

# Additional environment variables
extraEnv: []

# Pod security
podSecurityContext:
  fsGroup: 1000

securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  readOnlyRootFilesystem: false
  allowPrivilegeEscalation: false
